<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <title>Tactics Game</title>
    <script src='https://unpkg.com/vue'></script>
    <script src='https://code.jquery.com/jquery-3.1.1.js'></script>
    <script src='levels/level.js'></script>
    <script src='script.js'></script>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <main>
      
      <div id='leftpanel' class='panel'>
        
        <transition name='fade'>
          <div id='selected-terrain' v-if='space && space.terrain'>
            <div id='terrain-info' class='ui'>
              <div class='heading'><div class='icon' :class='space.terrain.type'></div>{{ space.terrain.name }}</div>
              <p v-if='space.terrain.cost < 99'>Move cost: <b>{{ space.terrain.cost }}</b></p>
              <p v-else>Impassable</p>
              <p v-if='space.terrain.cover > 0'>Cover: <b>{{ space.terrain.cover }}</b>
                <span v-if='space.terrain.coverDirection' class='small'>vs attacks from <b>{{ space.terrain.coverDirection }}</b></span>
              </p>
              <p v-if='space.terrain.elevation > 0'>Elevation: <b>{{ space.terrain.elevation }}</b></p>
            </div>
          </div>
        </transition>
        
        <transition :name='dynamicTransition'>
          <div id='selected-unit' v-if='space && space.unit'>
            <div id='unit-info' class='ui'>
              <div class='heading'><div class='icon' :class='space.unit.faction'></div>{{ space.unit.name }}</div>
              <p>Condition: <b :class='space.unit.condition'>{{ space.unit.condition }}</b></p>
              <p>Offense: <b>{{ space.unit.offense }}</b></p>
              <p>Defense: <b>{{ space.unit.defense }}</b> <b class='buff' v-if='defenseBonus > 0'>+{{ defenseBonus }}</b></p>
              <p>Range: <b>{{ space.unit.range }}</b></p>
              <p>Movement: <b>{{ space.unit.moves }} / {{ space.unit.movement }}</b></p>
            </div>
            <div id='unit-combat' class='ui' v-if='attack'>
              <p class='heading'><img class='icon' src='sprites/combat-icon.png'>Combat Info</p>
              <p>Attack success chance: <b :style='gradient'>{{ attack }}%</b></p>
            </div>
            <div id='unit-actions' class='ui' v-if="space.unit.faction === 'Player'">
              <p class='heading'><img class='icon' src='sprites/actions-icon.png'>Actions</p>
              <p v-if="!action || action === 'moving'">
                <button id='btn-move' v-if='!action' :disabled='space.unit.moves === 0' @click='beginMove'>Move (M)</button>
                <button id='btn-unmove' v-else @click='cancelMove'>Cancel Move (M)</button>
              </p>
              <p v-if="!action || action === 'attacking'">
                <button id='btn-attack' v-if='!action' :disabled='space.unit.attacks === 0' @click='beginAttack'>Attack (A)</button>
                <button id='btn-unattack' v-else @click='cancelAttack'>Cancel Attack (A)</button>
              </p>
              <div v-if="!action || action === 'ending'">
                <p v-if='!action'><button id='btn-end' @click="action = 'ending'">End Turn (E)</button></p>
                <p v-else>
                  Really end turn?<br>
                  <button id='btn-unend' @click='action = null'>Cancel (E)</button>
                  <button id='btn-confend' @click='endTurn'>Confirm (Return)</button>
                </p>
              </div>
            </div>
          </div>
        </transition>
        
      </div>
      
      <div id='map' class='panel' :style='mapImage'>
        <row v-for='row in gameData' :key='row' :row='row'></row>
      </div>
      
      <div id='rightpanel' class='panel'>
        
        <transition name='fade'>
          <div id='target-space' v-if='space && space.terrain'>
            <div id='target-terrain' class='ui'>
              <div class='heading'><div class='icon' :class='space.terrain.type'></div>{{ space.terrain.name }}</div>
              <p v-if='space.terrain.cost < 99'>Move cost: <b>{{ space.terrain.cost }}</b></p>
              <p v-else>Impassable</p>
              <p v-if='space.terrain.cover > 0'>Cover: <b>{{ space.terrain.cover }}</b>
                <span v-if='space.terrain.coverDirection' class='small'>vs attacks from <b>{{ space.terrain.coverDirection }}</b></span>
              </p>
              <p v-if='space.terrain.elevation > 0'>Elevation: <b>{{ space.terrain.elevation }}</b></p>
            </div>
          </div>
        </transition>
        
        <transition :name='dynamicTransition'>
          <div id='target-unit' v-if='space && space.unit'>
            <div id='target-info' class='ui'>
              <div class='heading'><div class='icon' :class='space.unit.faction'></div>{{ space.unit.name }}</div>
              <p>Condition: <b :class='space.unit.condition'>{{ space.unit.condition }}</b></p>
              <p>Offense: <b>{{ space.unit.offense }}</b></p>
              <p>Defense: <b>{{ space.unit.defense }}</b> <b class='buff' v-if='defenseBonus > 0'>+{{ defenseBonus }}</b></p>
              <p>Range: <b>{{ space.unit.range }}</b></p>
              <p>Movement: <b>{{ space.unit.moves }} / {{ space.unit.movement }}</b></p>
            </div>
            <div id='target-combat' class='ui' v-if='counter'>
              <p class='heading'><img class='icon' src='sprites/combat-icon.png'>Combat Info</p>
              <p>Counter success chance: <b :style='gradient'>{{ counter }}%</b></p>
            </div>
            <div id='target-actions' class='ui' v-if='counter || counter === 0'>
              <p class='heading'><img class='icon' src='sprites/actions-icon.png'>Actions</p>
              <p><button id='btn-confatk' @click='confirmAttack'>Confirm Attack (Return)</button></p>
            </div>
          </div>
        </transition>
        
      </div>
      
      <div id='bottompanel' class='panel'></div>
      
    </main>
  </body>
</html>